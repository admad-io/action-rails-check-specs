#!/usr/bin/env ruby

puts %x[pwd]
puts %x[ls -l]

missing_specs =
  %x[git diff --diff-filter=AM --name-only master... 'app/**/*.rb']
    .split("\n")
    .map { _1.sub(/^app/, "spec") }
    .map { _1.sub(/\.rb$/, "_spec.rb") }
    .reject(&File.:exist?)
    .each { puts format("Missing spec file: %s", _1) }

exit(1) if missing_specs.any?
